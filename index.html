<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>NeuroSync Prototype</title>
<style>
body{margin:0;font-family:sans-serif;background:#111;color:#fff;overflow:hidden;}
#network{position:absolute;top:0;left:0;width:100vw;height:100vh;}
#sidebar{position:absolute;top:0;right:0;width:200px;height:100vh;background:#222;padding:10px;}
.node{position:absolute;width:30px;height:30px;border-radius:50%;text-align:center;line-height:30px;color:#000;font-weight:bold;}
button{margin:5px;padding:5px;width:100%;}
</style>
</head>
<body>

<canvas id="network"></canvas>
<div id="sidebar">
<h3>Personal Mood</h3>
<label>Happiness: <input type="range" id="happy" min="0" max="100" value="50"></label><br>
<label>Anger: <input type="range" id="anger" min="0" max="100" value="0"></label><br>
<label>Focus: <input type="range" id="focus" min="0" max="100" value="50"></label><br>
<input type="text" id="wordInput" placeholder="Type word...">
<input type="color" id="colorInput" value="#00ff00">
<button onclick="sendChoice()">Add Node</button>
</div>

<script>
const canvas=document.getElementById('network');
const ctx=canvas.getContext('2d');
canvas.width=window.innerWidth;
canvas.height=window.innerHeight;
let nodes=[];

// WebSocket connection
const ws = new WebSocket('ws://localhost:8080');

ws.onmessage = (msg)=>{
    const data = JSON.parse(msg.data);
    if(data.type==='updateGraph'){
        nodes = data.graph;
    }
}

// Send choice
function sendChoice(){
    const word=document.getElementById('wordInput').value||'';
    const color=document.getElementById('colorInput').value;
    ws.send(JSON.stringify({type:'nodeChoice', word, color}));
}

// Draw loop
function draw(){
    ctx.clearRect(0,0,canvas.width,canvas.height);
    nodes.forEach((n,i)=>{
        const x = 100 + i*50 % (canvas.width-200);
        const y = 50 + Math.floor(i/10)*50;
        // draw node
        ctx.fillStyle = n.color;
        ctx.beginPath();
        ctx.arc(x,y,15,0,Math.PI*2);
        ctx.fill();
        ctx.fillStyle="#000";
        ctx.fillText(n.word.slice(0,2),x-7,y+5);

        // draw edges (connect to previous node)
        if(i>0){
            const prev = nodes[i-1];
            const px = 100 + (i-1)*50 % (canvas.width-200);
            const py = 50 + Math.floor((i-1)/10)*50;
            ctx.strokeStyle = n.color;
            ctx.lineWidth=2;
            ctx.beginPath();
            ctx.moveTo(x,y);
            ctx.lineTo(px,py);
            ctx.stroke();
        }
    });
    requestAnimationFrame(draw);
}
draw();
</script>

</body>
</html>

<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>PeerQuantum Habit Mesh - Adaptive Demo</title>
<style>
  body {
    font-family: Arial, sans-serif;
    background: #0b0c1d;
    color: #fff;
    margin: 0;
    padding: 20px;
  }
  .container { max-width: 500px; margin: auto; }
  h1 { text-align: center; color: #6cf; }
  label { display: block; margin-top: 15px; }
  select, button { padding: 10px; font-size: 1em; margin-top: 5px; width: 100%; }
  .habit-card { background: #1a1b36; margin-top: 15px; padding: 15px; border-radius: 10px; text-align: center; }
  .habit-card button { margin-top: 10px; }
  .nudge { color: #0f0; font-weight: bold; margin-top: 10px; }
  .high-contrast { background: #000; color: #fff; }
</style>
</head>
<body>
<div class="container">
  <h1>PeerQuantum Habit Mesh</h1>

  <!-- Profile Selector -->
  <label for="profile">Select Profile / Persona:</label>
  <select id="profile">
    <option value="child">Child</option>
    <option value="teen">Teen</option>
    <option value="adult">Adult</option>
    <option value="senior">Senior</option>
    <option value="guardian">Family Guardian</option>
  </select>

  <!-- Accessibility Toggle -->
  <label>
    <input type="checkbox" id="highContrast"> High Contrast Mode
  </label>
  <label>
    <input type="checkbox" id="voiceMode"> Enable Voice Input/Output
  </label>

  <!-- Habit Cards -->
  <div id="habits"></div>
</div>

<script type="module">
  // === Sample Habit Data by Persona ===
  const habitsByProfile = {
    child: ["Brush Teeth", "Homework", "Playtime"],
    teen: ["Exercise", "Study", "Social Time"],
    adult: ["Work", "Exercise", "Family Time"],
    senior: ["Medicine", "Walk", "Reading"],
    guardian: ["Monitor Kids", "Encourage Seniors", "Family Check-ins"]
  };

  const profileSelect = document.getElementById('profile');
  const habitsDiv = document.getElementById('habits');
  const highContrastCheckbox = document.getElementById('highContrast');
  const voiceCheckbox = document.getElementById('voiceMode');

  // Render habit cards based on profile
  function renderHabits(profile) {
    habitsDiv.innerHTML = '';
    const habits = habitsByProfile[profile] || [];
    habits.forEach(habit => {
      const card = document.createElement('div');
      card.className = 'habit-card';
      card.innerHTML = `
        <div>${habit}</div>
        <button>Check-In âœ…</button>
        <div class="nudge">Nudge: ${generateNudge(profile)}</div>
      `;
      habitsDiv.appendChild(card);

      const btn = card.querySelector('button');
      btn.addEventListener('click', () => {
        alert(`Checked in: ${habit}`);
        if (voiceCheckbox.checked) speak(`Great job! You completed ${habit}`);
      });
    });
  }

  // Nudge messages based on profile
  function generateNudge(profile) {
    switch(profile) {
      case 'child': return "Play and learn!";
      case 'teen': return "Stay focused!";
      case 'adult': return "Keep your balance!";
      case 'senior': return "Keep moving gently!";
      case 'guardian': return "Guide your family!";
      default: return "";
    }
  }

  // Voice Output using Web Speech API
  function speak(text) {
    if (!('speechSynthesis' in window)) return;
    const utterance = new SpeechSynthesisUtterance(text);
    speechSynthesis.speak(utterance);
  }

  // Accessibility toggles
  highContrastCheckbox.addEventListener('change', () => {
    document.body.classList.toggle('high-contrast', highContrastCheckbox.checked);
  });

  profileSelect.addEventListener('change', () => {
    renderHabits(profileSelect.value);
  });

  // Initialize default profile
  renderHabits(profileSelect.value);

  // === Placeholder P2P Family Mesh ===
  async function startFamilyMesh() {
    console.log("P2P Family Mesh initialized (placeholder)");
    // You can integrate libp2p or WebRTC mesh here
  }

  startFamilyMesh();
</script>
</body>
</html>
